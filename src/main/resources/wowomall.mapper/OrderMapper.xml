<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.xmu.wowoto.wowomall.mapper.OrderMapper">

<insert id="addOrder" parameterType="WowoOrder" useGeneratedKeys="true" keyProperty="id">
    insert into wowomall_order(
        user_id, be_shared_item_ids, order_sn, status, mobile, message, goods_price, freight_price, coupon_price, integral_price, rebate_price, ship_sn, ship_channel, ship_time, confirm_time, end_time, pay_time, parent_id, address, gmt_create, gmt_modified, be_deleted
    )
    values (
        #{userId}, #{beSharedItemIds}, #{orderSn}, #{statusCode}, #{mobile}, #{message}, #{goodsPrice}, #{freightPrice}, #{couponPrice}, #{integralPrice}, #{rebatePrice}, #{shipSn}, #{shipChannel}, #{shipTime}, #{confirmTime}, #{endTime}, #{payTime}, #{parentId}, #{address}, now(), #{gmtModified}, #{beDeleted}
    )
</insert>

<select id="getOrdersByStatusCode" parameterType="java.util.List" resultType="WowoOrder">
    select *
    from wowomall_order
    where user_id = #{userId} and is_deleted = 0
    <if test="statusCode!=0">
        and status_code = #{statusCode}
    </if>
    order by #{sort} #{order}
    limit #{page}, #{limit}
</select>

<select id="getOrderByOrderId" parameterType="Integer" resultType="WowoOrder">
    select *
    from wowomall_order
    where be_deleted = 0 and id = #{orderId}
</select>

<update id="updateOrderSelective" parameterType="WowoOrder">
    update wowomall_order
    <set>
        <if test="userId != null">
            user_id = #{userId},
        </if>
        <if test="beSharedItemIds != null">
            be_shared_item_ids = #{beSharedItemIds},
        </if>
        <if test="orderSn != null">
            order_sn = #{orderSn},
        </if>
        <if test="statusCode != null">
            status = #{statusCode},
        </if>
        <if test="consignee != null">
            consignee = #{consignee},
        </if>
        <if test="mobile != null">
            mobile = #{mobile},
        </if>
        <if test="message != null">
            message= #{message},
        </if>
        <if test="goodsPrice != null">
            goods_price = #{goodsPrice},
        </if>
        <if test="freightPrice != null">
            freight_price = #{freightPrice},
        </if>
        <if test="couponPrice != null">
            coupon_price = #{couponPrice},
        </if>
        <if test="integralPrice != null">
            integral_price = #{integralPrice},
        </if>
        <if test="rebatePrice != null">
            rebate_price = #{rebatePrice},
        </if>
        <if test="shipSn != null">
            ship_sn = #{shipSn},
        </if>
        <if test="shipChannel != null">
            ship_channel = #{shipChannel},
        </if>
        <if test="shipTime != null">
            ship_time = #{shipTime},
        </if>
        <if test="confirmTime != null">
            confirm_time = #{confirmTime},
        </if>
        <if test="endTime != null">
            end_time = #{endTime},
        </if>
        <if test="payTime != null">
            pay_time = #{payTime},
        </if>
        <if test="parentId != null">
            parent_id = #{parentId},
        </if>
        <if test="address != null">
            address = #{address},
        </if>
        <if test="gmtCreate != null">
            gmt_create = #{gmtCreate},
        </if>
        <if test="gmtModified != null">
            gmt_modified = now(),
        </if>
        <if test="beDeleted != null">
            be_deleted = #{beDeleted},
        </if>
    </set>
    where id = #{id}
</update>


</mapper>